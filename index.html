<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Vanilla JS センターカルーセル</title>
    <style>
        body {
            margin: 0;
            padding: 40px;
            background: #f4f6fb;
            font-family: sans-serif;
        }

        .carousel {
            max-width: 900px;
            margin: 0 auto;
        }

        .sliderArea {
            overflow-x: auto;
            scroll-snap-type: x mandatory;
            display: flex;
            gap: 20px;
            scrollbar-width: none;
            scroll-behavior: smooth;
            padding: 0 10%; /* 両端に余白を入れる */

        }

        .sliderArea::-webkit-scrollbar {
            display: none;
        }

        .slide {
            flex: 0 0 80%;
            scroll-snap-align: center;
            border-radius: 12px;
            overflow: hidden;
            transition: transform 0.4s ease, box-shadow 0.4s ease;
        }

        .slide img {
            width: 40%;
            height: auto;
            display: block;
        }

        .slide.active {
            transform: scale(1.05);
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.25);
            z-index: 2;
        }



        /* --- コントロールエリア --- */
        .controls {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
        }

        /* 矢印ボタン */
        .nav-btn {
            background: #fff;
            border: 1px solid #ccc;
            border-radius: 50%;
            width: 36px;
            height: 36px;
            cursor: pointer;
            font-size: 18px;
            font-weight: bold;
            line-height: 34px;
            text-align: center;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
        }

        .nav-btn:hover {
            background: #f0f0f0;
        }

        /* ドット */
        .dots {
            display: flex;
            gap: 10px;
        }

        .dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #ccc;
            cursor: pointer;
            transition: background 0.3s;
        }

        .dot.active {
            background: #2b6cb0;
        }
    </style>
</head>

<body>

    <div class="carousel">
        <div class="sliderArea" id="slider">
            <div class="slide"><img src="https://125naroom.com/demo/img/itukanokotonokoto01.jpg" alt=""></div>
            <div class="slide"><img src="https://125naroom.com/demo/img/itukanokotonokoto02.jpg" alt=""></div>
            <div class="slide"><img src="https://125naroom.com/demo/img/itukanokotonokoto03.jpg" alt=""></div>
            <div class="slide"><img src="https://125naroom.com/demo/img/itukanokotonokoto04.jpg" alt=""></div>
            <div class="slide"><img src="https://125naroom.com/demo/img/itukanokotonokoto05.jpg" alt=""></div>
        </div>

        <!-- 矢印とドットを一列に中央配置 -->
        <div class="controls">
            <button class="nav-btn prev">⟨</button>
            <div class="dots" id="dots"></div>
            <button class="nav-btn next">⟩</button>
        </div>
    </div>

    <script>
        const slider = document.getElementById('slider');
        const slides = Array.from(slider.children);
        const dotsContainer = document.getElementById('dots');
        const prevBtn = document.querySelector('.prev');
        const nextBtn = document.querySelector('.next');
        let currentIndex = 0;
        let autoPlayTimer;
        let userInteracted = false;

        // ドット生成
        slides.forEach((_, idx) => {
            const dot = document.createElement('span');
            dot.classList.add('dot');
            dot.addEventListener('click', () => {
                stopAutoPlay();
                goToSlide(idx);
            });
            dotsContainer.appendChild(dot);
        });
        const dots = Array.from(dotsContainer.children);

        // アクティブ更新
        function updateActive() {
            let closestIdx = 0;
            let closestDist = Infinity;
            const center = window.innerWidth / 2;

            slides.forEach((slide, idx) => {
                const rect = slide.getBoundingClientRect();
                const slideCenter = rect.left + rect.width / 2;
                const dist = Math.abs(center - slideCenter);
                if (dist < closestDist) {
                    closestDist = dist;
                    closestIdx = idx;
                }
            });

            currentIndex = closestIdx;
            slides.forEach(s => s.classList.remove('active'));
            dots.forEach(d => d.classList.remove('active'));
            slides[currentIndex].classList.add('active');
            dots[currentIndex].classList.add('active');
        }

        function goToSlide(idx) {
            slides[idx].scrollIntoView({ behavior: "smooth", inline: "center" });
            currentIndex = idx;
            updateActive();
        }

        function nextSlide() {
            let next = (currentIndex + 1) % slides.length;
            goToSlide(next);
        }
        function prevSlide() {
            let prev = (currentIndex - 1 + slides.length) % slides.length;
            goToSlide(prev);
        }

        prevBtn.addEventListener('click', () => { stopAutoPlay(); prevSlide(); });
        nextBtn.addEventListener('click', () => { stopAutoPlay(); nextSlide(); });

        slider.addEventListener('scroll', () => {
            window.requestAnimationFrame(updateActive);
            stopAutoPlay();
        });

        // 自動再生管理
        function startAutoPlay() {
            stopAutoPlay();
            autoPlayTimer = setInterval(nextSlide, 3000);
        }
        function stopAutoPlay() {
            clearInterval(autoPlayTimer);
            clearTimeout(userInteracted);
            userInteracted = setTimeout(startAutoPlay, 5000);
        }


        // 初期表示を真ん中から
        const middleIndex = Math.floor(slides.length / 2);
        goToSlide(middleIndex);
        startAutoPlay();
    </script>

</body>

</html>